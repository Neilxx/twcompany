<?php
$this->title = $this->unit->name() . ':' . $this->unit->id() . ':';
?>
<?= $this->partial('/common/header.phtml', $this) ?>
<table border="1">
    <tr>
        <td colspan="2">
            <h2>經濟部資料</h2>
            <a href="/index/redirect?type=<?= $this->unit->type ?>&id=<?= $this->unit->id ?>&gcis.nat.gov.tw">原始資料</a>
        </td>
    </tr>
    <tr>
        <td>欄位</td>
        <td>值</td>
    </tr>
    <tr>
        <td>API URL</td>
        <td><a href="/api/show/<?= $this->unit->id() ?>">http://<?= $_SERVER['HTTP_HOST'] ?>/api/show/<?= $this->unit->id() ?></a></td>
    </tr>
    <tr>
        <td>ID</td>
        <td><?= $this->unit->id() ?></td>
    </tr>
    <tr>
        <td>Updated_at</td>
        <td><?= date('c', $this->unit->updated_at) ?></td>
    </tr>
    <?php foreach (UnitData::search(array('id' => $this->unit->id)) as $unitdata) { ?>
    <tr>
        <td><?= ColumnGroup::getColumnName($unitdata->column_id) ?></td>
        <td><?= $this->partial('/index/data_show.phtml', array('value' => $unitdata->value, 'column_id' => $unitdata->column_id, 'name' => $this->unit->name())) ?></td>
    </tr>
    <?php } ?>
    <?php if (count(FIAUnitData::search(array('id' => $this->unit->id)))) { ?>
    <tr>
        <td colspan="2">
            <h2>財政部資料</h2>
            <a href="https://www.etax.nat.gov.tw/etwmain//front/ETW113W1_1?vatId=<?= $this->unit->id ?>">原始資料</a>
        </td>
    </tr>
    <tr>
        <td>欄位</td>
        <td>值</td>
    </tr>
    <?php foreach (FIAUnitData::search(array('id' => $this->unit->id)) as $unitdata) { ?>
    <tr>
        <td><?= FIAColumnGroup::getColumnName($unitdata->column_id) ?></td>
        <td><?= $this->partial('/index/data_show.phtml', array('value' => $unitdata->value, 'column_id' => $unitdata->column_id, 'name' => $this->unit->name(), 'type' => 'fia')) ?></td>
    </tr>
    <?php } ?>
    <?php } ?>
</table>
<?= $this->partial('/common/footer.phtml', $this) ?>
